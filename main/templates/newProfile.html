<html>
<head>
    <title>
    {% if id == -1 %}
        Новый профиль
    {% else %}
        Редактировать профиль
    {% endif %}
    </title>
    <script>
        function foo()
        {
            let selector = document.getElementById('new_rule')
            let selected_rule = selector.value
            let rules = document.getElementById('rules')
            console.log(rules.innerHTML)
            rules.InnerHTML = '<a href="test">test</a>'           // Если поддерживаем IE, может требоваться innerText
            
        }
    </script>
</head>
<body>
    <form action="." method="POST">
        {% csrf_token %}
        Название: <input type="text" name="name" value="{{ name }}"/><br/>
        Правила:
        <div id="rules">
            <input type="hidden" name="rule_count" value="{{ profile_rule_count }}"/>
            {% for rule in profile_rules %}
                <select name="rule{{ forloop.counter }}">
                    {% for rule2 in rules %}
                        {% if rule == rule2 %}
                            <option selected value="{{ rule2.name }}">{{ rule2.name }}</option>
                        {% else %}
                            <option value="{{ rule2.name }}">{{ rule2.name }}</option>
                        {% endif %}
                    {% endfor %}
                </select><br/>
            {% endfor %}
        </div>
        <select id="new_rule" onchange=foo()>
            {% for rule in rules %}
                <option value="{{ rule.name }}">{{ rule.name }}</option>
            {% endfor %}
            <option value="" selected></option>
        </select><br/>
        {% if id != -1 %}
            <input type=hidden name="profile_id" value="{{ id }}"/>
        {% endif %}
        <input type="submit" value="Сохранить"/>
    </form>
</body>
</html>